
function [M,Det]=NUA(gamma_plus,epi_plus,mu_plus,gamma_minus,epi_minus,mu_minus,kx,kz,w)
k2 = w*(gamma_plus + sqrt(epi_plus*mu_plus));%wavenumber_1
k1 = w*(gamma_minus + sqrt(epi_minus*mu_minus)); %wavenumber_2
xh = pi/4;%interface_point
a = 2*pi;%period condition with bloch condition

Ex = exp(i*kx*a);
%% 1~5
M1 = [0, 0, -cos(k1*xh), -sin(k1*xh), 0, 0, 0, 0, 0, 0, 0, 0     , 0,...
    0, cos(k2*xh), sin(k2*xh), 0, 0, 0, 0, 0, 0, 0, 0];

M2 = [0, 0, 0, 0, -cos(k1*xh), -sin(k1*xh), 0, 0, 0, 0, 0, 0     , 0,...
    0, 0, 0, cos(k2*xh), sin(k2*xh), 0, 0, 0, 0, 0, 0];

M3 = [-w*(epi_minus - gamma_minus^2/mu_minus)*cos(k1*xh), -w*(epi_minus - gamma_minus^2/mu_minus)*...
    sin(k1*xh), i*(gamma_minus*kz/mu_minus)*cos(k1*xh), i*(gamma_minus*kz/mu_minus)*sin(k1*xh), 0,...
    0, 0, 0, 0, 0, 0, 0     , w*(epi_plus - gamma_plus^2/mu_plus)*cos(k2*xh), ...
   w*(epi_plus - gamma_plus^2/mu_plus)*sin(k2*xh), -i*(gamma_plus*kz/mu_plus)*...
    cos(k2*xh), -i*(gamma_plus*kz/mu_plus)*sin(k2*xh), 0, 0, 0, 0, 0, 0, 0, 0];

M4 = [i*kz/mu_minus*cos(k1*xh), ...
   i*kz/mu_minus*sin(k1*xh), -w*(gamma_minus/mu_minus)*cos(k1*xh), -w*(gamma_minus/mu_minus)*...
    sin(k1*xh), k1/mu_minus*sin(k1*xh), -k1/mu_minus*cos(k1*xh), 0, 0, 0, 0, 0, ...
   0, -i*kz/mu_plus*cos(k2*xh), -i*kz/mu_plus*sin(k2*xh), ...
   w*(gamma_plus/mu_plus)*cos(k2*xh), w*(gamma_plus/mu_plus)*sin(k2*xh), -k2/mu_plus*sin(k2*xh), ...
   k2/mu_plus*cos(k2*xh), 0, 0, 0, 0, 0, 0];

M5 = [0, 0, -(k1/mu_minus)*sin(k1*xh), ...   
   k1/mu_minus*cos(k1*xh), -w*(gamma_minus/mu_minus)*cos(k1*xh), -w*(gamma_minus/mu_minus)*sin(k1*xh), ...
   0, 0, 0, 0, 0, 0     , 0, ...
   0, (k2/mu_plus)*sin(k2*xh), -(k2/mu_plus)*cos(k2*xh), ...
   w*(gamma_plus/mu_plus)*cos(k2*xh), w*(gamma_plus/mu_plus)*sin(k2*xh), 0, 0, 0, 0, 0, 0];
%% 6~10
M6 = [0, 0, 0, 0, 0, 0, 0, 0, -cos(k1*xh), -sin(k1*xh), 0, 0     , 0,...
    0, 0, 0, 0, 0, 0, 0, cos(k2*xh), sin(k2*xh), 0, 0];

M7 = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -cos(k1*xh), -sin(k1*xh)     , 0,...
    0, 0, 0, 0, 0, 0, 0, 0, 0, cos(k2*xh), sin(k2*xh)];

M8 = [0, 0, 0, 0, 0, ...
   0, -(mu_minus - gamma_minus^2/epi_minus)*cos(k1*xh), -(mu_minus - gamma_minus^2/epi_minus)*...
    sin(k1*xh), -(gamma_minus*kz/(epi_minus*w)*cos(k1*xh)), -(gamma_minus*kz/(epi_minus*w)*...
      sin(k1*xh)), 0, 0    , 0, 0, 0, 0, 0, ...
   0, (mu_plus - gamma_plus^2/epi_plus)*cos(k2*xh), (mu_plus - gamma_plus^2/epi_plus)*...
    sin(k2*xh), (gamma_plus*kz/(epi_plus*w)*cos(k2*xh)), (gamma_plus*kz/(epi_plus*w)*...
     sin(k2*xh)), 0, 0];
 
M9 = [0, 0, 0, 0, 0, ...
   0, -(kz/(w*epi_minus)*cos(k1*xh)), -(kz/(w*epi_minus)*...
      sin(k1*xh)), -(gamma_minus/epi_minus)*cos(k1*xh), -(gamma_minus/epi_minus)*...
    sin(k1*xh), -(k1/(i*w*epi_minus)*sin(k1*xh)), (k1/(i*w*epi_minus)*...
     cos(k1*xh))     , 0, 0, 0, 0, 0, ...
   0, (kz/(w*epi_plus)*cos(k2*xh)), (kz/(w*epi_plus)*sin(k2*xh)), (gamma_plus/epi_plus)*...
    cos(k2*xh), (gamma_plus/epi_plus)*...
    sin(k2*xh), (k2/(i*w*epi_plus)*...
     sin(k2*xh)), -(k2/(i*w*epi_plus)*cos(k2*xh)) ];
 
M10 = [0, 0, 0, 0, 0, 0, 0, 0, ...
   k1/(i*w*epi_minus)*sin(k1*xh), -k1/(i*w*epi_minus)*cos(k1*xh), -(gamma_minus/epi_minus)*...
    cos(k1*xh), -(gamma_minus/epi_minus)*sin(k1*xh)     , 0, 0, 0, 0, 0, 0, 0, ...
   0, -k2/(i*w*epi_plus)*sin(k2*xh), ...
   k2/(i*w*epi_plus)*cos(k2*xh), (gamma_plus/epi_plus)*cos(k2*xh), (gamma_plus/epi_plus)*...
    sin(k2*xh)];
%%
M11 =i*w*[-epi_minus*cos(k1*xh), -epi_minus*sin(k1*xh), 0, 0, 0, ...
   0, -i*gamma_minus*cos(k1*xh), -i*gamma_minus*sin(k1*xh), 0, 0, 0, 0     , ...
   epi_plus*cos(k2*xh), epi_plus*sin(k2*xh), 0, 0, 0, 0, i*gamma_plus*cos(k2*xh), ...
   i*gamma_plus*sin(k2*xh), 0, 0, 0, 0];
M12 = i*w*[i*gamma_minus*cos(k1*xh), i*gamma_minus*sin(k1*xh), 0, 0, 0, ...
   0, -mu_minus*cos(k1*xh), -mu_minus*sin(k1*xh), 0, 0, 0, 0     , ...
   -i*gamma_plus*cos(k2*xh), -i*gamma_plus*sin(k2*xh), 0, 0, 0, 0, mu_plus*cos(k2*xh), ...
   mu_plus*sin(k2*xh), 0, 0, 0, 0];
%% fix 
M13 = i*w*[epi_minus*k1*sin(k1*xh), -epi_minus*k1*cos(k1*xh), 0, 0, 0, 0, ...
   i*gamma_minus*k1*sin(k1*xh), -i*gamma_minus*k1*cos(k1*xh), 0, 0, 0, 0     , ...
   -epi_plus*k2*sin(k2*xh), epi_plus*k2*cos(k2*xh), 0, 0, 0, ...
   0, -i*gamma_plus*k2*sin(k2*xh), i*gamma_plus*k2*cos(k2*xh), 0, 0, 0, 0];
M16 = i*w*[-i*gamma_minus*k1*sin(k1*xh), i*gamma_minus*k1*cos(k1*xh), 0, 0, 0, 0,... 
   mu_minus*k1*sin(k1*xh), -mu_minus*k1*cos(k1*xh), 0, 0, 0, ...
   0     , i*gamma_plus*k2*sin(k2*xh), -i*gamma_plus*k2*cos(k2*xh), 0, 0, 0, ...
   0, mu_plus*k2*sin(k2*xh), -mu_plus*k2*cos(k2*xh), 0, 0, 0, 0];
%%


M14 = [0, 0, k1*sin(k1*xh), k1*-cos(k1*xh), 0, 0, 0, 0, 0, 0, 0, ...
   0     , 0, 0, -k2*sin(k2*xh), k2*cos(k2*xh), 0, 0, 0, 0, 0, 0, 0, ...
   0];
M15 = [0, 0, 0, 0, k1*sin(k1*xh), k1*-cos(k1*xh), 0, 0, 0, 0, 0, ...
   0     , 0, 0, 0, 0, -k2*sin(k2*xh), k2*cos(k2*xh), 0, 0, 0, 0, 0, ...
   0];
M17 = [0, 0, 0, 0, 0, 0, 0, 0, k1*sin(k1*xh), k1*-cos(k1*xh), 0, ...
   0     , 0, 0, 0, 0, 0, 0, 0, 0, -k2*sin(k2*xh), k2*cos(k2*xh), 0, ...
   0];
M18 = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, k1*sin(k1*xh), ...
   k1*-cos(k1*xh)     , 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -k2*sin(k2*xh), ...
   k2*cos(k2*xh)];
%% fix
M19 = i*w*[-epi_minus, 0, 0, 0, 0, 0, -i*gamma_minus, 0, 0, 0, 0, 0     ,... 
   epi_plus*Ex, 0, 0, 0, 0, 0, 0, i*gamma_plus*Ex, 0, 0, 0, 0];
M22 = i*w*[i*gamma_minus, 0, 0, 0, 0, 0, -mu_minus, 0, 0, 0, 0, 0     , ...
   -i*gamma_plus*Ex, 0, 0, 0, 0, 0, mu_plus*Ex, 0, 0, 0, 0, 0];
%%
M20 = [0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0     , 0, 0, -Ex, 0, 0, 0, ...
   0, 0, 0, 0, 0, 0];
M21 = [0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0     , 0, 0, 0, 0, -Ex, 0, ...
   0, 0, 0, 0, 0, 0];
M23 = [0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0     , 0, 0, 0, 0, 0, 0, 0, ...
   0, -Ex, 0, 0, 0];
M24 = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0     , 0, 0, 0, 0, 0, 0, 0, ...
   0, 0, 0, -Ex, 0];
M=[M1;M2;M3;M4;M5;M6;M7;M8;M9;M10;M11;M12;M13;M14;M15;M16;M17;M18;M19;M20;M21;M22;M23;M24];
Det=det(M);
end